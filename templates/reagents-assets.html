{{block "reagents-search" .}}
  <div id="search-results" >
    {{range .ReagentsSlice}}
      <button onClick="window.location.href='/reagents/{{.ID}}';" class="flex bg-yellow mt-2 rounded-md shadow-lg shadow-gray w-full">
        <ul class="list-none">
          <div class="pl-8 pr-8 pt-3 text-left">{{.Name}}</div>
          <div class="pl-8 pr-8 pb-3 text-left">{{.Formula}}</div>
        </ul>
      </button>
    {{end}}
    {{if .NextOffset}}
      <button onClick="window.location.href='/reagents/{{.LastReagent.ID}}';" hx-get="/api/v1/reagents/?src={{.Src}}&offset={{.NextOffset}}" hx-trigger="revealed" hx-swap="afterend" class="flex bg-yellow mt-2 rounded-md shadow-lg shadow-gray w-full">
        <ul class="list-none">
          <div class="pl-8 pr-8 pt-3 text-left">{{.LastReagent.Name}}</div>
          <div class="pl-8 pr-8 pb-3 text-left">{{.LastReagent.Formula}}</div>
        </ul>
      </button>
    {{end}}
  </div>
{{end}}

{{block "subscript-tip-popover" .}}
  <div class="flex items-left relative inline-block popover-wrapper">
    <div class="flex justify-center text-center select-none rounded-full w-9 h-9 py-1 border-2 border-gray-dark">?</div>
    <div class="absolute mt-12 p-2 bg-gray-dark text-white popover-content w-48 rounded-md">Натисніть і утримуйте Ctrl для вводу цифр з нижнім індексом</div>
  </div>
{{end}}

{{block "reagents-bar" .}}
  <div class="flex justify-between bg-gray-light">
    <div class="flex w-1/6">
      {{if eq .Caller.Role.Name "assistant"}}
        <button onClick="window.location.href='/reagent-new';" class="bg-gray-light hover:bg-gray hover:text-white text-xl font-serif font-bold w-full py-4 rounded">
          Створити
        </button>
      {{end}}
    </div>
    <div class="flex w-1/3">
      <input onKeyUp="return subscriptNumbers(event)" type="search" name="src" placeholder="назва реагенту чи формула" maxlength="50" class="flex w-full rounded-full px-6 my-2 border-2 border-gray-dark" hx-get="/api/v1/reagents/" hx-trigger="keyup changed delay:400ms" hx-target="#search-results" hx-swap="outerHTML"/>
      <div class="flex ml-4 py-3">
        {{template "subscript-tip-popover" .}}
      </div>
    </div>
    <div class="w-1/6"></div>
  </div>
{{end}}

{{block "reagent-form" .}}
  <div id="reagent-form" class="grid grid-cols-10 gap-0">
    <div class="text-xl font-serif flex justify-center items-center col-span-2">Назва</div>
    <textarea name="name" maxlength="300" rows="3" style="resize: none;" class="col-span-8 rounded-md border-2 border-{{if .NameErr}}red{{else}}gray{{end}}">{{.Name}}</textarea>
    <div class="h-9 min-h-full col-span-2"></div>
    <div class="col-span-8 py-1">{{.NameErr}}</div>
    <div class="text-center text-xl font-serif flex justify-center items-center col-span-2">Формула</div>
    <input onKeyUp="return subscriptNumbers(event)" type="text" name="formula" value='{{.Formula}}' maxlength="50" class="col-span-7 rounded-md border-2 border-{{if .FormulaErr}}red{{else}}gray{{end}}"/>
    <div class="flex ml-4 py-1">
      {{template "subscript-tip-popover" .}}
    </div>
    <div class="h-9 min-h-full col-span-2"></div>
    <div class="col-span-8 py-1">{{.FormulaErr}}</div>
  </div>
{{end}}

{{block "reagent-data" .}}
  <div class="grid grid-cols-10 gap-0">
    <div class="col-span-10 text-center">{{.Name}}</div>
    <div class="col-span-10 text-left">{{.Formula}}</div>
  </div>
{{end}}

{{block "reagent" .}}
  <div id="reagent">
    {{template "reagent-data" .}}
    {{ if eq .Caller.Role.Name "assistant" }}
      <div class="flex w-full justify-center">
        <button hx-post="/api/v1/reagents/{{.ID}}/form/edit" hx-ext="json-enc" hx-vals='{"name": "{{.Name}}", "formula": "{{.Formula}}"}' hx-swap="outerHTML" hx-target="#reagent" class="bg-gray-dark hover:bg-gray text-white text-xl font-serif font-bold justify-center w-1/3 py-4 mt-4 rounded-md">Редагувати</button>
      </div>
    {{end}}
  </div>
{{end}}

{{block "reagent-edit" .}}
  <div id="reagent">
    {{template "reagent-form" .}}
    <div class="flex w-full justify-evenly">
      <button hx-put="/api/v1/reagents/{{.ID}}" hx-swap="outerHTML" hx-target="#reagent-form" hx-ext="json-enc" hx-include="[name='name'], [name='formula']" hx-headers='{"_xsrf": "{{ .PutXsrf }}"}' class="bg-gray-dark hover:bg-gray text-white text-xl font-serif font-bold justify-center w-1/3 py-4 mt-4 rounded-md">Зберегти</button>
      <button hx-get="/api/v1/reagents/{{.ID}}/form/read" hx-swap="outerHTML" hx-target="#reagent" class="bg-gray-dark hover:bg-gray text-white text-xl font-serif font-bold justify-center w-1/3 py-4 mt-4 rounded-md">Відміна</button>
    </div>
  </div>
{{end}}
